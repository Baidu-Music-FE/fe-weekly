<!DOCTYPE html>
<html>
<head>
	<script src="/assets/markdown/sh/shCore.js"></script>
	<script src="/assets/markdown/sh/brushes.js"></script>
	<link rel="stylesheet" href="/assets/markdown/sh/shCoreDefault.css">

	<link rel="stylesheet" href="/assets/markdown/default.css">
	<title>Nobone Documentation</title>
</head>
<body>

<div id="main">
	<h1 id="-ie6-">竞品IE6兼容情况调查</h1>
<p>主要竞品的PC web IE6测试结果见下图：</p>
<table>
<thead>
<tr>
<th>竞品名称</th>
<th>基本功能</th>
<th>整体布局（宽屏)</th>
<th>整体布局（窄屏）</th>
<th>细节布局</th>
</tr>
</thead>
<tbody>
<tr>
<td>酷狗</td>
<td>正常</td>
<td>基本正常</td>
<td>主体无适配</td>
<td>底部推广连接hover时布局被破坏</td>
</tr>
<tr>
<td>虾米</td>
<td>正常</td>
<td>导航和歌单部分布局被破坏</td>
<td>主体无适配</td>
<td>交互时控件错位较多</td>
</tr>
<tr>
<td>网易云音乐</td>
<td>播放操作卡顿</td>
<td>全部正常</td>
<td>主体无适配</td>
<td>未发现明显错误</td>
</tr>
<tr>
<td>QQ音乐</td>
<td>全部</td>
<td>全部正常</td>
<td>主体无适配</td>
<td>少数图标链接背景有错误</td>
</tr>
<tr>
<td>酷我</td>
<td>全部</td>
<td>全部正常</td>
<td>主体无适配</td>
<td>未发现明显错误</td>
</tr>
</tbody>
</table>
<p>注：在测试这些竞品网站之前本想对比他们对自适应布局的支持程度，结果所有竞品都未作自适应版本。</p>
<p><strong>综合看来主站的ie6兼容性工作应该是业界较为复杂的，但从流量（5%）统计和竞品表现情况来看，ie6的支持工作暂时十分必要。</strong></p>
<ul>
<li><p>从测试结果来看，除了面向中高端用户的虾米之外，其余竞品在ie6兼容性上都做了不少工作，其中腾讯的做法十分值得学习，在许多控件的动态效果上为了避免卡顿做了降级处理。</p>
</li>
<li><p>QQ音乐和网易云音乐的PC web设计上较为简单，模块数量不多，酷我和酷狗使大部分的页面元素是静态列表，从动态效果和模块数量上主站的复杂度是最高的。</p>
</li>
<li><p>暂时还没用竞品采用浏览器检测提示更新的策略。</p>
</li>
</ul>
<p><strong>另外修复布局bug是有一定规律可循的，例如ie6盒模型的bug导致尺寸计算错误，利用元素hasLayout属性修复排版错误等，在有经验的情况下，额外增加的工作量不会太大。兼容性的工作量显然也取决于达成的效果的程度，所以我建议采取分级处理的策略：</strong></p>
<ul>
<li><p>在不影响用户使用的情况下，一些细节上的兼容性问题可以放在常规优化里解决。</p>
</li>
<li><p>影响到整体布局和视觉效果的的问题一定要尽快解决。上线之后不应该出现bug，这一点已经和QA达成共识。</p>
</li>
</ul>
<p>IE6检测和提示这个事情，作为技术大厂，我想十分有必要，一方面可以尽快降低ie6使用比例，另一方面也是提升产品用户体验的一个途径，这个事情希望能说服PM推动百度音乐各大产品线同时进行，不过也需要征求更多意见。</p>

</div>

<div id="toc">
	<h1>Table of Contents</h1>
	<div class="content"></div>
</div>

<script type="text/javascript" src="/assets/markdown/main.js"></script>

<script type="text/javascript">
	[].slice.apply(document.querySelectorAll('pre code[class]')).forEach(function (el) {
		var lang = el.getAttribute('class').replace('lang-', '');
		el.parentElement.setAttribute('class', 'brush: ' + lang + ';');
		el.parentElement.innerHTML = el.innerHTML
	});
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>

</body>
</html>


<!-- Nobone Client Helper -->
<script type="text/javascript">

// Generated by CoffeeScript 1.8.0
var Nobone;

Nobone = (function() {
  function Nobone(opts) {
    'use strict';
    var init, init_auto_reload, self;
    self = this;
    self.lang_current = opts.lang_current;
    self.lang_data = opts.lang_data;
    init = function() {
      if (opts.auto_reload) {
        return init_auto_reload();
      }
    };
    self.log = function(msg, action) {
      var req;
      if (action == null) {
        action = 'log';
      }
      console[action](msg);
      req = new XMLHttpRequest;
      req.open('POST', '/nobone-log');
      req.setRequestHeader('Content-Type', 'application/json');
      return req.send(JSON.stringify(msg));
    };
    self.lang = function(cmd, lang) {
      var en, i, _ref;
      if (lang == null) {
        lang = opts.lang_current;
      }
      i = cmd.lastIndexOf('|');
      en = i > -1 ? cmd.slice(0, i) : cmd;
      return ((_ref = opts.lang_data[lang]) != null ? _ref[cmd] : void 0) || en;
    };
    init_auto_reload = function() {
      var es;
      es = new EventSource(opts.host + '/nobone-sse/auto_reload');
      es.addEventListener('error', function(e) {
        return console.warn(e.message);
      });
      return es.addEventListener('file_modified', function(e) {
        var each, msg, reload_elem;
        msg = JSON.parse(e.data);
        console.log(">> file_modified: " + msg.req_path);
        reload_elem = function(el, key) {
          var body;
          if (el[key].indexOf('?') === -1) {
            el[key] += '?nb_auto_reload=0';
          } else {
            if (el[key].indexOf('nb_auto_reload') > -1) {
              el[key] = el[key].replace(/nb_auto_reload=(\d+)/, function(m, p) {
                return 'nb_auto_reload=' + (+p + 1);
              });
            } else {
              el[key] += '&nb_auto_reload=0';
            }
          }
          body = document.body;
          body.style.display = 'none';
          body.offsetHeight;
          return setTimeout(function() {
            return body.style.display = 'block';
          }, 50);
        };
        each = function(qs, handler) {
          var elems;
          elems = document.querySelectorAll(qs);
          return [].slice.apply(elems).forEach(handler);
        };
        if (!msg.req_path) {
          location.reload();
          return;
        }
        switch (msg.ext_bin) {
          case '.js':
            return each('script', function(el) {
              if (el.src.indexOf(msg.req_path) > -1) {
                return location.reload();
              }
            });
          case '.css':
            return each('link', function(el) {
              if (el.href.indexOf(msg.req_path) > -1) {
                return reload_elem(el, 'href');
              }
            });
          case '.jpg':
          case '.gif':
          case '.png':
            return each('img', function(el) {
              if (el.src.indexOf(msg.req_path) > -1) {
                return reload_elem(el, 'src');
              }
            });
          default:
            return location.reload();
        }
      });
    };
    init();
  }

  return Nobone;

})();

window.nb = new Nobone({"auto_reload":true,"lang_current":"en","host":""});

</script>

