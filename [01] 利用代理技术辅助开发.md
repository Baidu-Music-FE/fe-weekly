## 利用代理技术辅助开发

比如 FM 的开发大量的使用了代理技术。其中包括 js css 的自动 watch 编译代理，线上线下 API 自动代理，预览及代理。使用这些技术之后，无需修改 host 文件，也不用每次都费时编辑配置，一切过程都是自动的（自动识别线上线下环境，来选择正确的 ip）。如果 FM 不适用代理技术，那么开发必须依赖测试机，并且每次需要费大量时间 svn 同步和代码编译，才能看到一行代码修改的效果。使用之后无需登录开发机也能轻松开发。

## 一般策略

通常学习时用的都是一级代理，但实际上都是使用两级代理工作。相当于桥接了两个路由器的感觉。和 fiddler 之类的解决方案最大区别是：利用 node 编程控制能应对更复杂多变的需求，且跨平台。

0. 使用 SwitchySharp 在浏览器端做导流。（一级代理）


   SwitchySharp 设置容易，跨平台等特性，非常适合做代理入口。

   特殊情况无法使用SwitchySharp 时，可以使用系统全局 http 代理。这个设置会需要打开很多对话框，所以很少使用。

0. 使用 Node 在后端做可编程 Proxy 输出。（二级代理）


   Node 在后端可以利用 http 协议的丰富 header

   信息，应对不同的请求作出复杂操作，然后输出可控结果。

比如现在需要使用 RD 一个正在开发的 API，而这个 API 地址需要配置 host，且 url 不是线上地址。这时你可以直接使用线上地址，然后利用代理将这个地址代理到内网某个地址进行开发。

比如用代理自动生成 source map，这样无需单独为某个项目设置编译，自动根据请求全局识别路径生成 source map。

比如自动代理编译 coffee less stylus 之类的代码，无需单个项目单个项目的弄繁琐配置。

如果你觉得你可能需要用上这个技术，但不知道如何具体操作，可以单独找我交流。
